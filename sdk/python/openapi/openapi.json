{
  "openapi": "3.1.0",
  "info": {
    "title": "LightningRod API",
    "description": "Generate verified, grounded datasets at scale for LLM fine-tuning and evaluation",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "/api/public/v1"
    }
  ],
  "paths": {
    "/openai/chat/completions": {
      "post": {
        "tags": [
          "OpenAI Compatible"
        ],
        "summary": "Chat Completions",
        "description": "OpenAI Compatible API Endpoint for Foresight Models. Does not currently support streaming.",
        "operationId": "chat_completions_openai_chat_completions_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChatCompletionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ChatCompletionResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/transform-jobs": {
      "post": {
        "tags": [
          "Transform Jobs"
        ],
        "summary": "Create Transform Job",
        "description": "Create a new transform job",
        "operationId": "create_transform_job_transform_jobs_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateTransformJobRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransformJob"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/transform-jobs/{job_id}": {
      "get": {
        "tags": [
          "Transform Jobs"
        ],
        "summary": "Get Transform Job",
        "description": "Get a transform job by ID",
        "operationId": "get_transform_job_transform_jobs__job_id__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "job_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Job Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TransformJob"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}": {
      "get": {
        "tags": [
          "Datasets"
        ],
        "summary": "Get Dataset",
        "description": "Get dataset metadata including ID, row count, and schema",
        "operationId": "get_dataset_datasets__dataset_id__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "dataset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Dataset Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetMetadata"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/download-url": {
      "get": {
        "tags": [
          "Datasets"
        ],
        "summary": "Get Dataset Download Url",
        "description": "Get a temporary signed URL to download the dataset parquet file",
        "operationId": "get_dataset_download_url_datasets__dataset_id__download_url_get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "dataset_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Dataset Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetDownloadUrlResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/upload-url": {
      "post": {
        "tags": [
          "Datasets"
        ],
        "summary": "Get Dataset Upload Url",
        "description": "Get a temporary signed URL to upload a parquet file",
        "operationId": "get_dataset_upload_url_datasets_upload_url_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetUploadUrlResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/datasets/from-upload": {
      "post": {
        "tags": [
          "Datasets"
        ],
        "summary": "Create Dataset From Upload",
        "description": "Create a dataset from a previously uploaded parquet file",
        "operationId": "create_dataset_from_upload_datasets_from_upload_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateDatasetFromUploadRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetMetadata"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/samples/validate": {
      "post": {
        "tags": [
          "Samples"
        ],
        "summary": "Validate Sample",
        "description": "Validate a Sample object structure",
        "operationId": "validate_sample_samples_validate_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Sample"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidateSampleResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AnswerType": {
        "properties": {
          "answer_type": {
            "$ref": "#/components/schemas/AnswerTypeEnum",
            "description": "The type of answer expected for this question"
          },
          "answer_format_instruction": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Answer Format Instruction",
            "description": "Instructions describing how the answer should be formatted and given. If not set, uses default based on answer_type."
          },
          "labeler_instruction": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Labeler Instruction",
            "description": "Custom instructions for the labeler. If not set, uses default based on answer_type."
          },
          "question_generation_instruction": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Question Generation Instruction",
            "description": "Custom instructions for generating questions of this type. If not set, uses default based on answer_type."
          }
        },
        "type": "object",
        "required": [
          "answer_type"
        ],
        "title": "AnswerType"
      },
      "AnswerTypeEnum": {
        "type": "string",
        "enum": [
          "BINARY",
          "MULTIPLE_CHOICE",
          "CONTINUOUS",
          "FREE_RESPONSE"
        ],
        "title": "AnswerTypeEnum"
      },
      "ChatCompletionRequest": {
        "properties": {
          "model": {
            "type": "string",
            "title": "Model",
            "description": "ID of the model to use"
          },
          "messages": {
            "items": {
              "$ref": "#/components/schemas/ChatMessage"
            },
            "type": "array",
            "title": "Messages",
            "description": "A list of messages comprising the conversation so far"
          },
          "temperature": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Temperature",
            "description": "Sampling temperature between 0 and 2"
          },
          "max_tokens": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Tokens",
            "description": "Maximum number of tokens to generate"
          },
          "top_p": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Top P",
            "description": "Nucleus sampling parameter"
          },
          "stream": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Stream",
            "description": "Whether to stream back partial progress",
            "default": false
          },
          "n": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "N",
            "description": "Number of chat completion choices to generate",
            "default": 1
          },
          "stop": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Stop",
            "description": "Up to 4 sequences where the API will stop generating"
          }
        },
        "type": "object",
        "required": [
          "model",
          "messages"
        ],
        "title": "ChatCompletionRequest",
        "examples": [
          {
            "messages": [
              {
                "content": "Will Bitcoin increase by more than 10% over the next 3 months?",
                "role": "user"
              }
            ],
            "model": "foresight-v1"
          }
        ]
      },
      "ChatCompletionResponse": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "A unique identifier for the chat completion"
          },
          "object": {
            "type": "string",
            "const": "chat.completion",
            "title": "Object",
            "description": "The object type",
            "default": "chat.completion"
          },
          "created": {
            "type": "integer",
            "title": "Created",
            "description": "Unix timestamp of when the completion was created"
          },
          "model": {
            "type": "string",
            "title": "Model",
            "description": "The model used for the chat completion"
          },
          "choices": {
            "items": {
              "$ref": "#/components/schemas/Choice"
            },
            "type": "array",
            "title": "Choices",
            "description": "A list of chat completion choices"
          },
          "usage": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/Usage"
              },
              {
                "type": "null"
              }
            ],
            "description": "Usage statistics for the completion request"
          }
        },
        "type": "object",
        "required": [
          "id",
          "created",
          "model",
          "choices"
        ],
        "title": "ChatCompletionResponse"
      },
      "ChatMessage": {
        "properties": {
          "role": {
            "type": "string",
            "title": "Role",
            "description": "The role of the message author (system, user, or assistant)"
          },
          "content": {
            "type": "string",
            "title": "Content",
            "description": "The content of the message"
          }
        },
        "type": "object",
        "required": [
          "role",
          "content"
        ],
        "title": "ChatMessage",
        "examples": [
          {
            "content": "Will the S&P 500 close above 6000 by the end of 2025?",
            "role": "user"
          }
        ]
      },
      "Choice": {
        "properties": {
          "index": {
            "type": "integer",
            "title": "Index",
            "description": "The index of this choice"
          },
          "message": {
            "$ref": "#/components/schemas/ResponseMessage",
            "description": "The message generated by the model"
          },
          "finish_reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Finish Reason",
            "description": "The reason the model stopped generating tokens"
          }
        },
        "type": "object",
        "required": [
          "index",
          "message"
        ],
        "title": "Choice"
      },
      "CreateDatasetFromUploadRequest": {
        "properties": {
          "upload_id": {
            "type": "string",
            "title": "Upload Id"
          }
        },
        "type": "object",
        "required": [
          "upload_id"
        ],
        "title": "CreateDatasetFromUploadRequest"
      },
      "CreateTransformConfig": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/ForwardLookingQuestionGenerator"
          },
          {
            "$ref": "#/components/schemas/GdeltSeedGenerator"
          },
          {
            "$ref": "#/components/schemas/NewsSeedGenerator"
          },
          {
            "$ref": "#/components/schemas/Pipeline"
          },
          {
            "$ref": "#/components/schemas/QuestionAndLabelGenerator"
          },
          {
            "$ref": "#/components/schemas/QuestionGenerator"
          },
          {
            "$ref": "#/components/schemas/QuestionPipeline"
          },
          {
            "$ref": "#/components/schemas/WebSearchLabeler"
          }
        ],
        "discriminator": {
          "propertyName": "config_type",
          "mapping": {
            "FORWARD_LOOKING_QUESTION_GENERATOR": "#/components/schemas/ForwardLookingQuestionGenerator",
            "GDELT_SEED_GENERATOR": "#/components/schemas/GdeltSeedGenerator",
            "NEWS_SEED_GENERATOR": "#/components/schemas/NewsSeedGenerator",
            "PIPELINE": "#/components/schemas/Pipeline",
            "QUESTION_AND_LABEL_GENERATOR": "#/components/schemas/QuestionAndLabelGenerator",
            "QUESTION_GENERATOR": "#/components/schemas/QuestionGenerator",
            "QUESTION_PIPELINE": "#/components/schemas/QuestionPipeline",
            "WEB_SEARCH_LABELER": "#/components/schemas/WebSearchLabeler"
          }
        }
      },
      "CreateTransformJobRequest": {
        "properties": {
          "config": {
            "$ref": "#/components/schemas/CreateTransformConfig"
          },
          "input_dataset_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Input Dataset Id"
          },
          "batch_size": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Batch Size"
          }
        },
        "type": "object",
        "required": [
          "config"
        ],
        "title": "CreateTransformJobRequest"
      },
      "DatasetDownloadUrlResponse": {
        "properties": {
          "url": {
            "type": "string",
            "title": "Url"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "title": "Expires At"
          },
          "dataset_id": {
            "type": "string",
            "title": "Dataset Id"
          },
          "filename": {
            "type": "string",
            "title": "Filename"
          }
        },
        "type": "object",
        "required": [
          "url",
          "expires_at",
          "dataset_id",
          "filename"
        ],
        "title": "DatasetDownloadUrlResponse"
      },
      "DatasetMetadata": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id"
          },
          "num_rows": {
            "type": "integer",
            "title": "Num Rows"
          },
          "schema_base64": {
            "type": "string",
            "title": "Schema Base64"
          }
        },
        "type": "object",
        "required": [
          "id",
          "num_rows",
          "schema_base64"
        ],
        "title": "DatasetMetadata"
      },
      "DatasetUploadUrlResponse": {
        "properties": {
          "upload_id": {
            "type": "string",
            "title": "Upload Id"
          },
          "url": {
            "type": "string",
            "title": "Url"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "title": "Expires At"
          }
        },
        "type": "object",
        "required": [
          "upload_id",
          "url",
          "expires_at"
        ],
        "title": "DatasetUploadUrlResponse"
      },
      "FilterCriteria": {
        "properties": {
          "rubric": {
            "type": "string",
            "title": "Rubric",
            "description": "Scoring rubric/prompt for evaluating content"
          },
          "min_score": {
            "type": "number",
            "maximum": 1.0,
            "minimum": 0.0,
            "title": "Min Score",
            "description": "Minimum score threshold",
            "default": 0.5
          },
          "model_name": {
            "type": "string",
            "title": "Model Name",
            "description": "Name of the model (in openrouter) to use for scoring",
            "default": "openai/gpt-4.1-mini"
          }
        },
        "type": "object",
        "required": [
          "rubric"
        ],
        "title": "FilterCriteria",
        "description": "Reusable filter criteria for LLM-based content scoring and filtering."
      },
      "ForwardLookingQuestionGenerator": {
        "properties": {
          "config_type": {
            "type": "string",
            "const": "FORWARD_LOOKING_QUESTION_GENERATOR",
            "title": "Config Type",
            "description": "Type of transform configuration",
            "default": "FORWARD_LOOKING_QUESTION_GENERATOR"
          },
          "instructions": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Instructions",
            "description": "Additional instructions for question generation. If not provided, uses sensible defaults."
          },
          "examples": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Examples",
            "description": "Example questions to guide generation"
          },
          "bad_examples": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Bad Examples",
            "description": "Examples of questions to avoid"
          },
          "filter": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/FilterCriteria"
              },
              {
                "items": {
                  "$ref": "#/components/schemas/FilterCriteria"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Filter",
            "description": "Optional filter criteria to apply after question generation"
          },
          "include_default_filter": {
            "type": "boolean",
            "title": "Include Default Filter",
            "description": "Whether to include the default filter for generated questions",
            "default": true
          }
        },
        "type": "object",
        "title": "ForwardLookingQuestionGenerator"
      },
      "GdeltSeedGenerator": {
        "properties": {
          "config_type": {
            "type": "string",
            "const": "GDELT_SEED_GENERATOR",
            "title": "Config Type",
            "description": "Type of transform configuration",
            "default": "GDELT_SEED_GENERATOR"
          },
          "start_date": {
            "type": "string",
            "format": "date-time",
            "title": "Start Date",
            "description": "Start date for seed search"
          },
          "end_date": {
            "type": "string",
            "format": "date-time",
            "title": "End Date",
            "description": "End date for seed search"
          },
          "interval_duration_days": {
            "type": "integer",
            "title": "Interval Duration Days",
            "description": "Duration of each interval in days"
          },
          "max_count": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Count",
            "description": "Maximum number of seeds to generate. If None, process all intervals concurrently"
          },
          "concurrency_limit": {
            "type": "integer",
            "title": "Concurrency Limit",
            "description": "Maximum number of concurrent intervals when max_count is None",
            "default": 5
          },
          "articles_per_interval": {
            "type": "integer",
            "title": "Articles Per Interval",
            "description": "Number of articles to fetch per interval from BigQuery",
            "default": 1000
          },
          "scrape_concurrency_limit": {
            "type": "integer",
            "title": "Scrape Concurrency Limit",
            "description": "Maximum number of concurrent scraping requests",
            "default": 50
          }
        },
        "type": "object",
        "required": [
          "start_date",
          "end_date",
          "interval_duration_days"
        ],
        "title": "GdeltSeedGenerator"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "Label": {
        "properties": {
          "passthrough_data": {
            "additionalProperties": true,
            "type": "object",
            "title": "Passthrough Data"
          },
          "label": {
            "type": "string",
            "title": "Label"
          },
          "label_confidence": {
            "type": "number",
            "title": "Label Confidence"
          },
          "resolution_date": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Resolution Date"
          }
        },
        "type": "object",
        "required": [
          "label",
          "label_confidence",
          "resolution_date"
        ],
        "title": "Label"
      },
      "NewsContext": {
        "properties": {
          "context_type": {
            "type": "string",
            "const": "NEWS_CONTEXT",
            "title": "Context Type",
            "default": "NEWS_CONTEXT"
          },
          "rendered_context": {
            "type": "string",
            "title": "Rendered Context"
          },
          "search_query": {
            "type": "string",
            "title": "Search Query"
          }
        },
        "type": "object",
        "required": [
          "rendered_context",
          "search_query"
        ],
        "title": "NewsContext"
      },
      "NewsContextGenerator": {
        "properties": {
          "config_type": {
            "type": "string",
            "const": "NEWS_CONTEXT_GENERATOR",
            "title": "Config Type",
            "description": "Type of transform configuration",
            "default": "NEWS_CONTEXT_GENERATOR"
          },
          "search_query_generation_instructions": {
            "type": "string",
            "title": "Search Query Generation Instructions",
            "description": "Instructions for LLM to generate search query from question",
            "default": "You are helping generate a search query for Google News to find relevant information for answering a question.\n\nGiven the question, generate:\n1. A concise search query that will find relevant news articles\n2. A goal describing what information you're looking for\n\nThe search query should be specific enough to find relevant articles but not so narrow that it misses important context. Focus on the key entities, events, or topics mentioned in the question."
          },
          "num_articles": {
            "type": "integer",
            "title": "Num Articles",
            "description": "Number of news articles to fetch per question",
            "default": 5
          },
          "time_delta_days": {
            "type": "integer",
            "title": "Time Delta Days",
            "description": "Number of days to look back for news articles",
            "default": 30
          },
          "concurrency_limit": {
            "type": "integer",
            "title": "Concurrency Limit",
            "description": "Maximum number of concurrent news search tasks",
            "default": 10
          }
        },
        "type": "object",
        "title": "NewsContextGenerator"
      },
      "NewsSeedGenerator": {
        "properties": {
          "config_type": {
            "type": "string",
            "const": "NEWS_SEED_GENERATOR",
            "title": "Config Type",
            "description": "Type of transform configuration",
            "default": "NEWS_SEED_GENERATOR"
          },
          "start_date": {
            "type": "string",
            "format": "date-time",
            "title": "Start Date",
            "description": "Start date for seed search"
          },
          "end_date": {
            "type": "string",
            "format": "date-time",
            "title": "End Date",
            "description": "End date for seed search"
          },
          "interval_duration_days": {
            "type": "integer",
            "title": "Interval Duration Days",
            "description": "Duration of each interval in days"
          },
          "max_count": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Count",
            "description": "Maximum number of seeds to generate. If None, process all intervals concurrently"
          },
          "concurrency_limit": {
            "type": "integer",
            "title": "Concurrency Limit",
            "description": "Maximum number of concurrent intervals when max_count is None",
            "default": 5
          },
          "search_query": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              }
            ],
            "title": "Search Query",
            "description": "Search query for news articles. If multiple queries are provided, a separate search will be done for each query."
          },
          "articles_per_search": {
            "type": "integer",
            "title": "Articles Per Search",
            "description": "Number of articles to fetch per search (max 100). Each query/domain combination is a separate search.",
            "default": 10
          },
          "filter_criteria": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/FilterCriteria"
              },
              {
                "items": {
                  "$ref": "#/components/schemas/FilterCriteria"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Filter Criteria",
            "description": "Optional criteria for filtering news snippets before scraping"
          },
          "source_domain": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Source Domain",
            "description": "Optional URL source of the news articles, e.g. 'https://reuters.com/business', if multiple sources are provided, multiple searchers will be done for each interval"
          }
        },
        "type": "object",
        "required": [
          "start_date",
          "end_date",
          "interval_duration_days",
          "search_query"
        ],
        "title": "NewsSeedGenerator"
      },
      "Pipeline": {
        "properties": {
          "config_type": {
            "type": "string",
            "const": "PIPELINE",
            "title": "Config Type",
            "description": "Type of transform configuration",
            "default": "PIPELINE"
          },
          "transform_configs": {
            "items": {
              "$ref": "#/components/schemas/TransformConfig"
            },
            "type": "array",
            "title": "Transform Configs",
            "description": "List of transform configs to execute in sequence"
          }
        },
        "type": "object",
        "required": [
          "transform_configs"
        ],
        "title": "Pipeline"
      },
      "Question": {
        "properties": {
          "passthrough_data": {
            "additionalProperties": true,
            "type": "object",
            "title": "Passthrough Data"
          },
          "question_text": {
            "type": "string",
            "title": "Question Text"
          }
        },
        "type": "object",
        "required": [
          "question_text"
        ],
        "title": "Question"
      },
      "QuestionAndLabelGenerator": {
        "properties": {
          "config_type": {
            "type": "string",
            "const": "QUESTION_AND_LABEL_GENERATOR",
            "title": "Config Type",
            "description": "Type of transform configuration",
            "default": "QUESTION_AND_LABEL_GENERATOR"
          },
          "instructions": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Instructions",
            "description": "Instructions for question and label generation. If not provided, uses sensible defaults."
          },
          "examples": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Examples",
            "description": "Example questions with labels to guide generation"
          },
          "bad_examples": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Bad Examples",
            "description": "Examples of questions/labels to avoid"
          },
          "filter": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/FilterCriteria"
              },
              {
                "items": {
                  "$ref": "#/components/schemas/FilterCriteria"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Filter",
            "description": "Optional filter criteria to apply after question generation"
          },
          "questions_per_seed": {
            "type": "integer",
            "title": "Questions Per Seed",
            "description": "Number of question/label pairs to generate per seed",
            "default": 1
          },
          "answer_type": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/AnswerType"
              },
              {
                "type": "null"
              }
            ],
            "description": "The type of answer expected for generated questions"
          }
        },
        "type": "object",
        "title": "QuestionAndLabelGenerator"
      },
      "QuestionGenerator": {
        "properties": {
          "config_type": {
            "type": "string",
            "const": "QUESTION_GENERATOR",
            "title": "Config Type",
            "description": "Type of transform configuration",
            "default": "QUESTION_GENERATOR"
          },
          "instructions": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Instructions",
            "description": "Instructions for question generation. If not provided, uses sensible defaults."
          },
          "examples": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Examples",
            "description": "Example questions to guide generation"
          },
          "bad_examples": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Bad Examples",
            "description": "Examples of questions to avoid"
          },
          "filter": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/FilterCriteria"
              },
              {
                "items": {
                  "$ref": "#/components/schemas/FilterCriteria"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Filter",
            "description": "Optional filter criteria to apply after question generation"
          },
          "questions_per_seed": {
            "type": "integer",
            "title": "Questions Per Seed",
            "description": "Number of questions to generate per seed",
            "default": 1
          },
          "answer_type": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/AnswerType"
              },
              {
                "type": "null"
              }
            ],
            "description": "The type of answer expected for generated questions"
          }
        },
        "type": "object",
        "title": "QuestionGenerator"
      },
      "QuestionPipeline": {
        "properties": {
          "config_type": {
            "type": "string",
            "const": "QUESTION_PIPELINE",
            "title": "Config Type",
            "description": "Type of transform configuration",
            "default": "QUESTION_PIPELINE"
          },
          "seed_generator": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/NewsSeedGenerator"
              },
              {
                "$ref": "#/components/schemas/GdeltSeedGenerator"
              }
            ],
            "title": "Seed Generator",
            "description": "Configuration for seed generation",
            "discriminator": {
              "propertyName": "config_type",
              "mapping": {
                "GDELT_SEED_GENERATOR": "#/components/schemas/GdeltSeedGenerator",
                "NEWS_SEED_GENERATOR": "#/components/schemas/NewsSeedGenerator"
              }
            }
          },
          "question_generator": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/QuestionGenerator"
              },
              {
                "$ref": "#/components/schemas/ForwardLookingQuestionGenerator"
              }
            ],
            "title": "Question Generator",
            "description": "Configuration for question generation",
            "discriminator": {
              "propertyName": "config_type",
              "mapping": {
                "FORWARD_LOOKING_QUESTION_GENERATOR": "#/components/schemas/ForwardLookingQuestionGenerator",
                "QUESTION_GENERATOR": "#/components/schemas/QuestionGenerator"
              }
            }
          },
          "labeler": {
            "$ref": "#/components/schemas/WebSearchLabeler",
            "description": "Configuration for labeling"
          },
          "context_generators": {
            "anyOf": [
              {
                "items": {
                  "$ref": "#/components/schemas/NewsContextGenerator"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Context Generators",
            "description": "Optional list of context generators to run before rendering"
          },
          "renderer": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/QuestionRenderer"
              },
              {
                "type": "null"
              }
            ],
            "description": "Optional configuration for rendering the final prompt"
          },
          "answer_type": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/AnswerType"
              },
              {
                "type": "null"
              }
            ],
            "description": "The type of answer expected, flows to question generator and renderer"
          }
        },
        "type": "object",
        "required": [
          "seed_generator",
          "question_generator",
          "labeler"
        ],
        "title": "QuestionPipeline"
      },
      "QuestionRenderer": {
        "properties": {
          "config_type": {
            "type": "string",
            "const": "QUESTION_RENDERER",
            "title": "Config Type",
            "description": "Type of transform configuration",
            "default": "QUESTION_RENDERER"
          },
          "template": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Template",
            "description": "Custom template for rendering the prompt. If not provided, dynamically builds based on available content. Supports any column name as a placeholder (e.g., {question_text}). Special placeholders: {context} renders context objects, {answer_instructions} renders answer type instructions."
          },
          "answer_type": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/AnswerType"
              },
              {
                "type": "null"
              }
            ],
            "description": "The type of answer expected, used to render answer instructions"
          }
        },
        "type": "object",
        "title": "QuestionRenderer"
      },
      "RAGContext": {
        "properties": {
          "context_type": {
            "type": "string",
            "const": "RAG_CONTEXT",
            "title": "Context Type",
            "default": "RAG_CONTEXT"
          },
          "rendered_context": {
            "type": "string",
            "title": "Rendered Context"
          },
          "document_id": {
            "type": "string",
            "title": "Document Id"
          }
        },
        "type": "object",
        "required": [
          "rendered_context",
          "document_id"
        ],
        "title": "RAGContext"
      },
      "ResponseMessage": {
        "properties": {
          "role": {
            "type": "string",
            "title": "Role",
            "description": "The role of the message author"
          },
          "content": {
            "type": "string",
            "title": "Content",
            "description": "The content of the message"
          }
        },
        "type": "object",
        "required": [
          "role",
          "content"
        ],
        "title": "ResponseMessage"
      },
      "Sample": {
        "properties": {
          "seed": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/Seed"
              },
              {
                "type": "null"
              }
            ]
          },
          "question": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/Question"
              },
              {
                "type": "null"
              }
            ]
          },
          "label": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/Label"
              },
              {
                "type": "null"
              }
            ]
          },
          "prompt": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Prompt"
          },
          "context": {
            "anyOf": [
              {
                "items": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/NewsContext"
                    },
                    {
                      "$ref": "#/components/schemas/RAGContext"
                    }
                  ],
                  "discriminator": {
                    "propertyName": "context_type",
                    "mapping": {
                      "NEWS_CONTEXT": "#/components/schemas/NewsContext",
                      "RAG_CONTEXT": "#/components/schemas/RAGContext"
                    }
                  }
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Context"
          },
          "meta": {
            "additionalProperties": true,
            "type": "object",
            "title": "Meta",
            "default": {}
          }
        },
        "type": "object",
        "title": "Sample"
      },
      "Seed": {
        "properties": {
          "passthrough_data": {
            "additionalProperties": true,
            "type": "object",
            "title": "Passthrough Data"
          },
          "seed_text": {
            "type": "string",
            "title": "Seed Text"
          },
          "url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Url"
          },
          "seed_creation_date": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Seed Creation Date"
          },
          "search_query": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Search Query"
          }
        },
        "type": "object",
        "required": [
          "seed_text"
        ],
        "title": "Seed"
      },
      "TransformConfig": {
        "properties": {
          "config_type": {
            "$ref": "#/components/schemas/TransformType"
          }
        },
        "type": "object",
        "required": [
          "config_type"
        ],
        "title": "TransformConfig"
      },
      "TransformJob": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id"
          },
          "organization_id": {
            "type": "string",
            "title": "Organization Id"
          },
          "status": {
            "$ref": "#/components/schemas/TransformJobStatus"
          },
          "modal_function_call_id": {
            "type": "string",
            "title": "Modal Function Call Id"
          },
          "modal_app_id": {
            "type": "string",
            "title": "Modal App Id"
          },
          "transform_config": {
            "type": "string",
            "title": "Transform Config"
          },
          "input_dataset_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Input Dataset Id"
          },
          "output_dataset_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Output Dataset Id"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Updated At"
          }
        },
        "type": "object",
        "required": [
          "id",
          "organization_id",
          "status",
          "modal_function_call_id",
          "modal_app_id",
          "transform_config",
          "input_dataset_id",
          "output_dataset_id",
          "created_at",
          "updated_at"
        ],
        "title": "TransformJob"
      },
      "TransformJobStatus": {
        "type": "string",
        "enum": [
          "RUNNING",
          "COMPLETED",
          "FAILED"
        ],
        "title": "TransformJobStatus"
      },
      "TransformType": {
        "type": "string",
        "enum": [
          "NEWS_SEED_GENERATOR",
          "GDELT_SEED_GENERATOR",
          "QUESTION_GENERATOR",
          "QUESTION_AND_LABEL_GENERATOR",
          "QUESTION_FILTER",
          "FORWARD_LOOKING_QUESTION_GENERATOR",
          "QUESTION_QUALITY_SCORER",
          "SCORE_FILTER",
          "FILTER_CRITERIA",
          "WEB_SEARCH_LABELER",
          "NEWS_CONTEXT_GENERATOR",
          "PIPELINE",
          "QUESTION_PIPELINE",
          "SCULPT",
          "QUESTION_RENDERER"
        ],
        "title": "TransformType"
      },
      "Usage": {
        "properties": {
          "prompt_tokens": {
            "type": "integer",
            "title": "Prompt Tokens",
            "description": "Number of tokens in the prompt"
          },
          "completion_tokens": {
            "type": "integer",
            "title": "Completion Tokens",
            "description": "Number of tokens in the completion"
          },
          "total_tokens": {
            "type": "integer",
            "title": "Total Tokens",
            "description": "Total number of tokens used"
          }
        },
        "type": "object",
        "required": [
          "prompt_tokens",
          "completion_tokens",
          "total_tokens"
        ],
        "title": "Usage"
      },
      "ValidateSampleResponse": {
        "properties": {
          "valid": {
            "type": "boolean",
            "title": "Valid"
          },
          "message": {
            "type": "string",
            "title": "Message"
          }
        },
        "type": "object",
        "required": [
          "valid",
          "message"
        ],
        "title": "ValidateSampleResponse"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      },
      "WebSearchLabeler": {
        "properties": {
          "config_type": {
            "type": "string",
            "const": "WEB_SEARCH_LABELER",
            "title": "Config Type",
            "description": "Type of transform configuration",
            "default": "WEB_SEARCH_LABELER"
          },
          "confidence_threshold": {
            "type": "number",
            "title": "Confidence Threshold",
            "description": "Minimum confidence threshold for including questions",
            "default": 0.9
          },
          "concurrency_limit": {
            "type": "integer",
            "title": "Concurrency Limit",
            "description": "Maximum number of concurrent question processing tasks",
            "default": 10
          },
          "answer_type": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/AnswerType"
              },
              {
                "type": "null"
              }
            ],
            "description": "The type of answer expected, used to guide the labeler"
          }
        },
        "type": "object",
        "title": "WebSearchLabeler"
      }
    },
    "securitySchemes": {
      "HTTPBearer": {
        "type": "http",
        "scheme": "bearer"
      }
    }
  }
}